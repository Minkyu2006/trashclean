<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate ="~{layout/default}">
	<head>
		<style>
			#map {
				height: 400px;
			}
			.stat__circle {
				width: 100%;
				height: 400px;
			}
		</style>
	
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPWQiEPh0gq9T4qk1LdJBLqnR43JfcUy0&callback=initMap" async defer></script>
		<script>
			var locations = [
				['명동', 37.563576, 126.983431],
	            ['가로수길', 37.520300, 127.023008],
	            ['광화문', 37.575268, 126.976896],
	            ['남산', 37.550925, 126.990945],
	            ['이태원', 37.540223, 126.994005],
	            ['iSolabin', 37.14450, 127.03312]
			]
	
			var map;
			
			function initMap() {
				map = new google.maps.Map(document.getElementById('map'), {
					center: {lat: 37.14450, lng: 127.03312},
					zoom: 8,
					mapTypeControl: false,
					streetViewControl: false
				});
				
				var marker, i;
				
				var infowindow = new google.maps.InfoWindow();
				
				for (i = 0; i < locations.length; i++) {
					marker = new google.maps.Marker({
						position: new google.maps.LatLng(locations[i][1], locations[i][2]),
						map: map
					});
					
					google.maps.event.addListener(marker, 'click', (function(marker, i) {
						var content = '<div class="iw-container" id="iw-container">' +
							'<h2>' + (locations[i][0]) + '</h2>' +
							'<dl>' +
								'<dt>위치정보</dt>' +
								'<dd>00시00구00동</dd>' +
							'</dl>' +
						'</div>'
				        return function() {
				          infowindow.setContent(content);
				          infowindow.open(map, marker);
				        }
				      })(marker, i));
				}
			}
			
			$(function() {
				var piechart = c3.generate({
					bindto: "#pie_chart",
					data: {
						columns: [
							['정상', 6],
							['관심', 3],
							['심각', 1]
						],
						type: 'pie'
					},
					tooltip: {
						format: {
							value: function (value) {
								return value + '개';
							}
						}
					},
					color: {
						pattern: ['#007e37', '#ffc600', '#e35f5f']
					}
				});
				
				
				var barchart = c3.generate({
					bindto: "#bar_chart",
					data: {
						columns: [
							['쓰레기양', 80, 70, 20, 50, 60, 10, 90, 30, 40, 80]
						],
						type: "bar"
					},
					tooltip: {
						format: {
							value: function (value) {
								return value + '%'
							}
						}
					},
					axis: {
						x: {
							label: {
								text: '장비명',
								position: 'outer-center'
							},
							type: 'category',
							categories: ['s1', 's2', 's3', 's4', 's5', 's6', 's7', 's8', 's9', 's10'],
							tick: {
								centered: true
							}
						},
						y: {
							label: {
								text: '쓰레기양',
								position: 'outer-middle'
							},
							max: 100,
							min: 10
						}
					},
					legend: {
						hide: true
					},
					color: {
						pattern: ['#007e37']
					}
				})
			})
			
		</script>
	
	</head>

	<div layout:fragment="content" class="contents-body">
		<div class="map" id="map"></div>
		
		<div class="stat">
			<div class="stat__circle" id="pie_chart"></div>
			
			<div class="stat__bar" id="bar_chart"></div>
		</div>
	</div>
</html>